<!DOCTYPE html>
<html lang="ru">
  <head>  
    <meta charset="utf-8" />
    <!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><![endif]-->
    <title>Лабораторная работа 2</title>
    <link rel="stylesheet" href="https://www.x3dom.org/download/x3dom.css" />
    <script src="https://x3dom.org/download/dev/x3dom-full.debug.js"></script>
  </head>

    <body>

    <input type="button" id="nQQ_s" value="Включить / Выключить движение вазы" onclick='moveVASE();'
    style="background: #aee8cd; border: 2px solid rgb(1, 1, 1);border-radius: 1px; margin:20px 0px 0px 80px;">
    </input>

      <input type="button" id="nQQ_s" value="Включить / Выключить движение мороженного" onclick='moveICEC();'
    style="background: #aee8cd; border: 2px solid rgb(1, 1, 1);border-radius: 1px; margin:20px 10px 10px 80px;">
    </input>

    <body style='width:100%; height:100%; border:0; margin:0; padding:0; background: url("1.jpg") no-repeat fixed;
  background-size: cover; background-position: center;'>

      <X3D width="100vw" height="100vh">
        <Scene>


<!-- освещение -->
  <PointLight location="10 10 0" color="1 1 1" intensity="1"></PointLight>
  <DirectionalLight direction='-1 0 0' color='1 1 1' intensity='1' shadowIntensity='0.1'></DirectionalLight>
  <SpotLight direction="-1 0 0" color="1 1 1" location="10 10 0" radius='100' intensity="1" beamWidth="0.5" cutOffAngle="0.5"></SpotLight>

<!-- туман -->
  <Fog DEF='tuman' fogType="EXPONENTIAL" color="#b7f7d7" visibilityRange='200'></Fog>

<!-- навигация -->
  <Viewpoint DEF='camera' description="Начальный вид" position="-1 0 30" fieldOfView = "0.50" ></Viewpoint>

  <NavigationInfo type='EXAMINE' avatarSize="1 2 1" speed="5"></NavigationInfo>

      
<!--заполнение по четырём точкам-->
<!--ваза-->
<Transform DEF="VASE" translation = "0 0 0"> 
  <Transform translation = "1 0.157 -1">
    <Shape>
        <IndexedFaceSet ccw="true" colorPerVertex="true" convex="true"
            creaseAngle="0" solid="false"
            coordIndex="0 1 2 3 -1 0 4 7 3 -1 0 4 5 1 -1 1 5 6 2 -1 3 7 6 2"
            colorIndex="2 2 2 2 -1 2 0 1 2 -1 2 0 1 2 -1 0 1 0 1 -1 1 1 0 1">
        <Coordinate point="0 0 0, 0 0 -0.7, 0.7 0 -0.7, 0.7 0 0, 0 2 0, 0 2 -0.7, 0.7 2 -0.7, 0.7 2 0"></Coordinate>
        <ColorRGBA color="0 0.1 0.9 0.7, 0 0.5 0.5 0.7, 0 0 1 0.9"></ColorRGBA>
        </IndexedFaceSet>
    </Shape>
</Transform>

<!--треугольники-->
<!--лепестки-->
<Group DEF="flower">
<Transform translation = "1.25 2.61 -1.25">
    <shape>
        <IndexedTriangleSet index="0 1 2 3 4 5 0 6 7 2 6 8 2 9 10 11 12 13 14 15 16 17 19 18" solid="false">
            <Coordinate point="0 0 0, -0.2 0.07 -0.1, 0 0 -0.2, 0 0 -0.08, -0.15 0.07 -0.32, 0.1 0 -0.25,
            0.2 0 0, 0.1 0.07 0.2, -0.14 0.07 0.14, 0.2 0 -0.2 , 0.1 0.07 -0.4, 0.4 0.07 -0.1, 0.15 0 0.02, 0.15 0 -0.22,
            0.15 0 0.08, 0.33 0.07 0.14, 0.1 0.0 -0.3, 0.18 0 -0.08, 0.1 0 -0.25, 0.3 0.07 -0.3"> 
                </Coordinate>
            <Color color="1 1 1, 1 1 1, 1 1 1, 1 1 1, 1 1 1, 1 1 1, 1 1 1, 1 1 1, 1 1 1, 1 1 1,
             1 1 1, 1 1 1, 1 1 1, 1 1 1, 1 1 1, 1 1 1, 1 1 1, 1 1 1, 1 1 1, 1 1 1, 1 1 1">
                </Color>
        </IndexedTriangleSet>
  </shape>
</Transform>

<!--листья-->
<transform translation='1.35 1.8 -1.35'>
  <shape>
    <IndexedTriangleStripSet index='0 1 2 3 -1 4 5 6 7-1' solid='false'>
      <Coordinate point='0 -0.1 0, 0.2 0.1 0, 0.1 0.3 0, 0.3 0.4 0, 
                         -0.05 0 0, -0.3 0.25 0, -0.15 0.5 0, -0.4 0.6 0'></Coordinate>
      <Color color='0.2 1 0, 0 1 0, 0.5 1 0, 0 1 0 , 0.2 1 0 , 0.3 1 0 , 0.4 1 0 , 0 1 0 , 0.1 1 0 '></Color>
     </IndexedTriangleStripSet>
  </shape>
  </transform>

    <!--стебль-->  
        <Transform translation = "1.35 1.35 -1.35">
            <Shape>
                <Appearance>
                    <Material diffuseColor = "0.2 1 0" ></Material>
                </Appearance> 
                <Cylinder Radius = "0.05" height = "2.55" solid = "false"></Cylinder>
            </Shape>    
        </Transform>

   <!--цветок1-->  
        <Transform translation = "1.35 2.65 -1.35">
            <Shape>
                <Appearance>
                    <Material diffuseColor = "1 1 0" ></Material>
                </Appearance> 
                <Cylinder Radius = "0.13" height = "0.02" solid = "false"></Cylinder>
            </Shape>    
        </Transform>

   <!--цветок2-->  
        <Transform translation = "1.35 2.61 -1.35">
            <Shape>
                <Appearance>
                    <Material diffuseColor = "0.2 1 0" ></Material>
                </Appearance> 
                <Cylinder Radius = "0.089" height = "0.05" solid = "false"></Cylinder>
            </Shape>    
        </Transform>
        </Group>

        <Transform translation="-0.24 -0.0 -0.2" rotation="0 0 1 -0.13">
          <Shape USE="flower">
          </Shape>
        </Transform>

        <Transform translation="0.05 -0.4 -0.2" rotation="1 0 0 0.18">
          <Shape USE="flower">
          </Shape>
        </Transform>
    </Transform>

<!--трава-->  
 <Transform translation = "-9 -4.8 -8">
         <Shape>
            <Appearance>
               <imagetexture url="g.jpg"></imagetexture>
            </Appearance>
            <ElevationGrid xDimension="6" zDimension="6"
               height="1.5, 1, 0.5, 0.5, 1, 1.15, 
               1, 0.5, 0.25, 0.25, 0.5, 1, 
               0.5, 0.2, 0.25, 0.25, 0.25, 0.15, 
               0.5, 0.2, 0.25, 0.25, 0.25, 0.15, 
               1, 0.5, 0.25, 0.25, 0.5, 1, 
               1.15, 1, 0.5, 0.5, 1, 1.15 "
               xSpacing="3" zSpacing="3" solid="false">
            </ElevationGrid>
        </Shape>
   </Transform>

    <!-- стол-->
    <!-- столешница-->
        <Transform translation = "0 0 0">
            <Shape>
                <Appearance>
                    <TextureTransform></TextureTransform>
                    <ImageTexture url = "wood1.png"></ImageTexture>
                </Appearance>
                <Box size="5 0.3 5" solid = "false"></Box>
            </Shape>
        </Transform>  

    <!-- ножка-->
        <Transform translation = "0 -2.25 0">
            <Shape>
                <Appearance>
                    <TextureTransform></TextureTransform>
                    <ImageTexture url = "light.png"></ImageTexture>
                </Appearance>
                <Cylinder solid = "false" height = "4.5" radius = "0.15"></Cylinder>
            </Shape>
        </Transform>

    <!--основание ножки-->  
        <Transform translation = "0 -4.25 0">
            <Shape>
                <Appearance>
                    <TextureTransform scale = "5 1"></TextureTransform>
                    <ImageTexture url = "wood3.png"></ImageTexture>
                </Appearance> 
                <Cone bottomRadius = "1.5" height = "0.5" solid = "false"></Cone>
            </Shape>    
        </Transform>

    <!-- стул-->
    <!-- сидушка-->
        <Transform translation = "-5.5 -2.05 0">
            <Shape>
                <Appearance>
                    <TextureTransform></TextureTransform>
                    <ImageTexture url = "woodw.png"></ImageTexture>
                </Appearance>
                <Box size="2.25 0.25 2.25" solid = "false"></Box>
            </Shape>
        </Transform>  

    <!-- ножки стула-->
    <!-- 1-->
        <Transform translation = "-6.5 -3.35 0.9">
            <Shape DEF="Taburetka">
                <Appearance>
                    <TextureTransform></TextureTransform>
                    <ImageTexture url = "woodw.png"></ImageTexture>
                </Appearance>
                <Box size="0.2 2.4 0.2" solid = "false"></Box>
            </Shape>
        </Transform>
    <!-- 2--> 
        <Transform translation = "-6.5 -3.35 -0.9">
            <Shape USE="Taburetka"> </Shape>
        </Transform>
    <!-- 3--> 
        <Transform translation = "-4.5 -3.35 0.9">
            <Shape USE="Taburetka"></Shape>
        </Transform>
    <!-- 4-->   
        <Transform translation = "-4.5 -3.35 -0.9">
            <Shape USE="Taburetka"></Shape>
        </Transform>  


    <!-- мороженное-->
    <!-- вазочка--> 
        <Transform DEF="ICEC" translation = "-1 0 0">
        <Transform rotation = "1 0 0 3.14">
        <Transform translation = "0 -0.75 0">
            <Shape>
                <Appearance>
                <Material diffuseColor = "0.5 0.7 0.8" specularColor = "0.44 0.28 0.89" transparency = "0.05"></Material>
                </Appearance> 
                <Cone bottomRadius = "0.51" height = "0.5" solid = "false" bottom = "false"></Cone>
            </Shape>    
        </Transform>
        </Transform>  
    <!-- ножка-->
        <Transform translation = "0 0.35 0">
            <Shape>
                <Appearance>
                    <Material diffuseColor = "0.5 0.7 0.8" specularColor = "0.44 0.28 0.89" transparency = "0.05"></Material>
                </Appearance>
                <Cylinder solid = "false" height = "0.5" radius = "0.07"></Cylinder>
            </Shape>
        </Transform>
    <!--основание ножки-->  
        <Transform translation = "0 0.22 0">
            <Shape>
                <Appearance>
                    <Material diffuseColor = "0.5 0.7 0.8" specularColor = "0.44 0.28 0.89" transparency = "0.05"></Material>
                </Appearance> 
                <Cone bottomRadius = "0.25" height = "0.15" solid = "false"></Cone>
            </Shape>    
        </Transform>


    <!-- мороженное-->
    <!-- 1-->
        <Transform translation = "0.15 1 -0.15">
          <Anchor url="https://ru.wikipedia.org/wiki/%D0%9C%D0%BE%D1%80%D0%BE%D0%B6%D0%B5%D0%BD%D0%BE%D0%B5" parameter="target='_self'">
            <Shape DEF="Ice">
                <Appearance>
                    <TextureTransform></TextureTransform>
                    <ImageTexture url = "ice1.png"></ImageTexture>
                </Appearance> 
                <Sphere Radius = "0.2" solid = "false" ></Sphere>
            </Shape> 
            </Anchor>   
        </Transform>
    <!-- 2-->
        <Transform translation = "0.1 0.96 0.15">
            <Shape USE="Ice"></Shape>    
        </Transform>
    <!-- 3-->
        <Transform translation = "-0.15 0.95 0.05">
            <Shape USE="Ice"></Shape>
        </Transform>
    <!-- 4-->
        <Transform translation = "0 0.8 0">
             <Shape USE="Ice"></Shape>
        </Transform>


    <!-- ободок вазочки-->
        <Transform rotation = "-1 0 0 1.57">
        <Transform translation = "0 0 1">
            <Shape>
                <Appearance>
                    <Material diffuseColor = "0.5 0.7 0.8" specularColor = "0.44 0.28 0.89" transparency = "0.05"></Material>
                </Appearance> 
                <Torus innerRadius = "0.02" outerRadius = "0.5" solid = "false" ></Torus>
            </Shape>    
        </Transform>
        </Transform>


    <!--палочка-->
     <Transform translation = "0 1.15 0" rotation="0 0 1 -0.5">
            <Shape>
                <Appearance>
                    <TextureTransform></TextureTransform>
                    <ImageTexture url = "w2.png"></ImageTexture>
                </Appearance>
                <Box size="0.06 0.6 0.01" solid = "false"></Box>
            </Shape>
        </Transform> 
        </Transform>  


    <!--текст-->
            <Transform translation = "-4 1.5 -2"  rotation="0 0 0 -0.8" >
                <Shape>
                    <Appearance>
                         <Material diffuseColor = "0 0.7 0.6" ></Material>
                    </Appearance>
                    <Text string = "Ира 4841" solid = "false" ></Text>
                         <FontStyle size = "1" style = "ITALIC" family = "Lucida Sans Typewriter" ></FontStyle>
                </Shape>
            </Transform>

      
      <!-- перемещение мороженного -->
      <TimeSensor id='QQ_ICEC' DEF='QQ_ICEC' cycleInterval='5' loop='true'></TimeSensor>
      <positionInterpolator DEF='PosInt' key='0, 0.2, 0.4, 0.6, 0.8, 1'
        keyValue='-0.6 0 0.1, -0.6 0 -0.6, 0.4 0 -0.6, 0.4 0 0.6, -0.6 0 0.6, -0.7 0 0.1'>
      </positionInterpolator>
      <PositionChaser DEF="PosCh" duration="1"></PositionChaser>
      <ROUTE fromNode='QQ_ICEC' fromField='fraction_changed' toNode='PosInt' toField='set_fraction'>
      </ROUTE>
      <ROUTE fromNode="PosInt" fromField="value_changed" toNode="PosCh" toField="set_destination">
      </ROUTE>
      <ROUTE fromNode='PosInt' fromField='value_changed' toNode='ICEC' toField='set_translation'>
      </ROUTE>


      <!-- прокрутка вазы с цветами вокруг своей оси -->
      <TimeSensor id='QQ_VASE' DEF='QQ_VASE' cycleInterval='4' loop='true'></TimeSensor>
      <OrientationInterpolator DEF='OrientInt' key='0 0.5 1' keyValue='0 1 0 0, 0 1 0 -3.14, 0 1 0 -6.28'>
      </OrientationInterpolator>
      <OrientationChaser DEF="OriCh" duration="3"></OrientationChaser>
      <ROUTE fromNode='QQ_VASE' fromField='fraction_changed' toNode='OrientInt' toField='set_fraction'>
      </ROUTE>
      <ROUTE fromNode="OrientInt" fromField="value_changed" toNode="OriCh" toField="set_destination">
      </ROUTE>
      <ROUTE fromNode='OriCh' fromField='value_changed' toNode='VASE' toField='set_rotation'>
      </ROUTE>

  
      <!-- скрипты на остановку/включение анимации вазы-->
      <script>

        function moveVASE(what) {
          var button = (what == "VASE")
            ? document.getElementById("nQQ_VASE")
            : document.getElementById("nQQ_st");
          var TS = (what == "VASE")
            ? document.getElementById("QQ_st")
            : document.getElementById("QQ_VASE");
          var QQ_snabled = TS.getAttribute("enabled");
          if (QQ_snabled == "true") {
            TS.setAttribute("enabled", "false");
            button.value = (what == "VASE")
              ;
          }
          else {
            TS.setAttribute("enabled", "true");
            button.value = (what == "VASE")
              ;
          }
        }

         function moveICEC(what) {
          var button = (what == "ICEC")
            ? document.getElementById("nQQ_ICEC")
            : document.getElementById("nQQ_st");
          var TS = (what == "ICEC")
            ? document.getElementById("QQ_st")
            : document.getElementById("QQ_ICEC");
          var QQ_snabled = TS.getAttribute("enabled");
          if (QQ_snabled == "true") {
            TS.setAttribute("enabled", "false");
            button.value = (what == "ICEC")
              ;
          }
          else {
            TS.setAttribute("enabled", "true");
            button.value = (what == "ICEC")
              ;
          }
        }

       </script>

      </Scene>
    </X3D>
  </body> 
</html>
